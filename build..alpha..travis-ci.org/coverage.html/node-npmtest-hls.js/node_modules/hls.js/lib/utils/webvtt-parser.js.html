<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-hls.js/node_modules/hls.js/lib/utils/webvtt-parser.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-hls.js">npmtest-hls.js (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-hls.js/node_modules/hls.js/lib/utils/webvtt-parser.js</span></h1>
    <h2>
        
        Statements: <span class="metric">9.64% <small>(8 / 83)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">6.12% <small>(3 / 49)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">11.11% <small>(1 / 9)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">8.54% <small>(7 / 82)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-hls.js/node_modules/hls.js/lib/utils/</a> &#187; webvtt-parser.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
var _vttparser = require('./vttparser');
&nbsp;
var _vttparser2 = _interopRequireDefault(_vttparser);
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? obj : <span class="branch-1 cbranch-no" title="branch not covered" >{ default: obj };</span> }
&nbsp;
var cueString2millis = <span class="fstat-no" title="function not covered" >function cueString2millis(timeString) {</span>
<span class="cstat-no" title="statement not covered" >    var ts = parseInt(timeString.substr(-3));</span>
<span class="cstat-no" title="statement not covered" >    var secs = parseInt(timeString.substr(-6, 2));</span>
<span class="cstat-no" title="statement not covered" >    var mins = parseInt(timeString.substr(-9, 2));</span>
<span class="cstat-no" title="statement not covered" >    var hours = timeString.length &gt; 9 ? parseInt(timeString.substr(0, timeString.indexOf(':'))) : 0;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (isNaN(ts) || isNaN(secs) || isNaN(mins) || isNaN(hours)) {</span>
<span class="cstat-no" title="statement not covered" >        return -1;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    ts += 1000 * secs;</span>
<span class="cstat-no" title="statement not covered" >    ts += 60 * 1000 * mins;</span>
<span class="cstat-no" title="statement not covered" >    ts += 60 * 60 * 1000 * hours;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return ts;</span>
};
&nbsp;
var calculateOffset = <span class="fstat-no" title="function not covered" >function calculateOffset(vttCCs, cc, presentationTime) {</span>
<span class="cstat-no" title="statement not covered" >    var currCC = vttCCs[cc];</span>
<span class="cstat-no" title="statement not covered" >    var prevCC = vttCCs[currCC.prevCC];</span>
&nbsp;
    // This is the first discontinuity or cues have been processed since the last discontinuity
    // Offset = current discontinuity time
<span class="cstat-no" title="statement not covered" >    if (!prevCC || !prevCC.new &amp;&amp; currCC.new) {</span>
<span class="cstat-no" title="statement not covered" >        vttCCs.ccOffset = vttCCs.presentationOffset = currCC.start;</span>
<span class="cstat-no" title="statement not covered" >        currCC.new = false;</span>
<span class="cstat-no" title="statement not covered" >        return;</span>
    }
&nbsp;
    // There have been discontinuities since cues were last parsed.
    // Offset = time elapsed
<span class="cstat-no" title="statement not covered" >    while (prevCC &amp;&amp; prevCC.new) {</span>
<span class="cstat-no" title="statement not covered" >        vttCCs.ccOffset += currCC.start - prevCC.start;</span>
<span class="cstat-no" title="statement not covered" >        currCC.new = false;</span>
<span class="cstat-no" title="statement not covered" >        currCC = prevCC;</span>
<span class="cstat-no" title="statement not covered" >        prevCC = vttCCs[currCC.prevCC];</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    vttCCs.presentationOffset = presentationTime;</span>
};
&nbsp;
var WebVTTParser = {
    parse: <span class="fstat-no" title="function not covered" >function parse(vttByteArray, syncPTS, vttCCs, cc, callBack, errorCallBack) {</span>
        // Convert byteArray into string, replacing any somewhat exotic linefeeds with "\n", then split on that character.
<span class="cstat-no" title="statement not covered" >        var re = /\r\n|\n\r|\n|\r/g;</span>
<span class="cstat-no" title="statement not covered" >        var vttLines = String.fromCharCode.apply(null, new Uint8Array(vttByteArray)).trim().replace(re, '\n').split('\n');</span>
<span class="cstat-no" title="statement not covered" >        var cueTime = '00:00.000';</span>
<span class="cstat-no" title="statement not covered" >        var mpegTs = 0;</span>
<span class="cstat-no" title="statement not covered" >        var localTime = 0;</span>
<span class="cstat-no" title="statement not covered" >        var presentationTime = 0;</span>
<span class="cstat-no" title="statement not covered" >        var cues = [];</span>
<span class="cstat-no" title="statement not covered" >        var parsingError = void 0;</span>
<span class="cstat-no" title="statement not covered" >        var inHeader = true;</span>
        // let VTTCue = VTTCue || window.TextTrackCue;
&nbsp;
        // Create parser object using VTTCue with TextTrackCue fallback on certain browsers.
<span class="cstat-no" title="statement not covered" >        var parser = new _vttparser2.default();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        parser.oncue = <span class="fstat-no" title="function not covered" >function (cue) {</span></span>
            // Adjust cue timing; clamp cues to start no earlier than - and drop cues that don't end after - 0 on timeline.
<span class="cstat-no" title="statement not covered" >            var currCC = vttCCs[cc];</span>
<span class="cstat-no" title="statement not covered" >            var cueOffset = vttCCs.ccOffset;</span>
&nbsp;
            // Update offsets for new discontinuities
<span class="cstat-no" title="statement not covered" >            if (currCC &amp;&amp; currCC.new) {</span>
<span class="cstat-no" title="statement not covered" >                if (localTime) {</span>
                    // When local time is provided, offset = discontinuity start time - local time
<span class="cstat-no" title="statement not covered" >                    cueOffset = vttCCs.ccOffset = currCC.start;</span>
                } else {
<span class="cstat-no" title="statement not covered" >                    calculateOffset(vttCCs, cc, presentationTime);</span>
                }
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            if (presentationTime &amp;&amp; !localTime) {</span>
                // If we have MPEGTS but no LOCAL time, offset = presentation time + discontinuity offset
<span class="cstat-no" title="statement not covered" >                cueOffset = presentationTime + vttCCs.ccOffset - vttCCs.presentationOffset;</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            cue.startTime += cueOffset - localTime;</span>
<span class="cstat-no" title="statement not covered" >            cue.endTime += cueOffset - localTime;</span>
&nbsp;
            // Fix encoding of special characters. TODO: Test with all sorts of weird characters.
<span class="cstat-no" title="statement not covered" >            cue.text = decodeURIComponent(escape(cue.text));</span>
<span class="cstat-no" title="statement not covered" >            if (cue.endTime &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >                cues.push(cue);</span>
            }
        };
&nbsp;
<span class="cstat-no" title="statement not covered" >        parser.onparsingerror = <span class="fstat-no" title="function not covered" >function (e) {</span></span>
<span class="cstat-no" title="statement not covered" >            parsingError = e;</span>
        };
&nbsp;
<span class="cstat-no" title="statement not covered" >        parser.onflush = <span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >            if (parsingError &amp;&amp; errorCallBack) {</span>
<span class="cstat-no" title="statement not covered" >                errorCallBack(parsingError);</span>
<span class="cstat-no" title="statement not covered" >                return;</span>
            }
<span class="cstat-no" title="statement not covered" >            callBack(cues);</span>
        };
&nbsp;
        // Go through contents line by line.
<span class="cstat-no" title="statement not covered" >        vttLines.forEach(<span class="fstat-no" title="function not covered" >function (line) {</span></span>
<span class="cstat-no" title="statement not covered" >            if (inHeader) {</span>
                // Look for X-TIMESTAMP-MAP in header.
<span class="cstat-no" title="statement not covered" >                if (line.startsWith('X-TIMESTAMP-MAP=')) {</span>
                    // Once found, no more are allowed anyway, so stop searching.
<span class="cstat-no" title="statement not covered" >                    inHeader = false;</span>
                    // Extract LOCAL and MPEGTS.
<span class="cstat-no" title="statement not covered" >                    line.substr(16).split(',').forEach(<span class="fstat-no" title="function not covered" >function (timestamp) {</span></span>
<span class="cstat-no" title="statement not covered" >                        if (timestamp.startsWith('LOCAL:')) {</span>
<span class="cstat-no" title="statement not covered" >                            cueTime = timestamp.substr(6);</span>
                        } else <span class="cstat-no" title="statement not covered" >if (timestamp.startsWith('MPEGTS:')) {</span>
<span class="cstat-no" title="statement not covered" >                            mpegTs = parseInt(timestamp.substr(7));</span>
                        }
                    });
<span class="cstat-no" title="statement not covered" >                    try {</span>
                        // Calculate subtitle offset in milliseconds.
                        // If sync PTS is less than zero, we have a 33-bit wraparound, which is fixed by adding 2^33 = 8589934592.
<span class="cstat-no" title="statement not covered" >                        syncPTS = syncPTS &lt; 0 ? syncPTS + 8589934592 : syncPTS;</span>
                        // Adjust MPEGTS by sync PTS.
<span class="cstat-no" title="statement not covered" >                        mpegTs -= syncPTS;</span>
                        // Convert cue time to seconds
<span class="cstat-no" title="statement not covered" >                        localTime = cueString2millis(cueTime) / 1000;</span>
                        // Convert MPEGTS to seconds from 90kHz.
<span class="cstat-no" title="statement not covered" >                        presentationTime = mpegTs / 90000;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >                        if (localTime === -1) {</span>
<span class="cstat-no" title="statement not covered" >                            parsingError = new Error('Malformed X-TIMESTAMP-MAP: ' + line);</span>
                        }
                    } catch (e) {
<span class="cstat-no" title="statement not covered" >                        parsingError = new Error('Malformed X-TIMESTAMP-MAP: ' + line);</span>
                    }
                    // Return without parsing X-TIMESTAMP-MAP line.
<span class="cstat-no" title="statement not covered" >                    return;</span>
                } else <span class="cstat-no" title="statement not covered" >if (line === '') {</span>
<span class="cstat-no" title="statement not covered" >                    inHeader = false;</span>
                }
            }
            // Parse line by default.
<span class="cstat-no" title="statement not covered" >            parser.parse(line + '\n');</span>
        });
&nbsp;
<span class="cstat-no" title="statement not covered" >        parser.flush();</span>
    }
};
&nbsp;
module.exports = WebVTTParser;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Wed Apr 26 2017 02:29:40 GMT+0000 (UTC)</div>
</div>
</body>
</html>
